<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quadratic Equation Solver</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/2.16.1/plotly.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: lightblue;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: inline-block;
            width: 150px;
        }
        input {
            padding: 5px;
            width: 100px;
        }
        button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            cursor: pointer;
            border-radius: 4px;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        #equation-display {
            font-size: 1.2em;
            margin: 20px 0;
            text-align: center;
        }
        #results {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            display: none;
        }
        #plot {
            width: 100%;
            height: 400px;
            background-color: white;
        }
    </style>
</head>
<body>
    <h1>Quadratic Equation Solver</h1>
    <p>Enter the coefficients for the quadratic equation y = ax² + bx + c</p>

    <div class="form-group">
        <label for="coefficient-a">Coefficient a:</label>
        <input type="number" id="coefficient-a" step="0.1" value="1">
    </div>

    <div class="form-group">
        <label for="coefficient-b">Coefficient b:</label>
        <input type="number" id="coefficient-b" step="0.1" value="0">
    </div>

    <div class="form-group">
        <label for="coefficient-c">Coefficient c:</label>
        <input type="number" id="coefficient-c" step="0.1" value="0">
    </div>

    <button onclick="calculateQuadratic()">Calculate</button>

    <div id="equation-display">y = x²</div>

    <div id="plot"></div>

    <div id="results">
        <h3>Results:</h3>
        <p id="root-status"></p>
        <p id="roots"></p>
        <p id="discriminant"></p>
    </div>

    <script>
        // Update equation display when inputs change
        document.getElementById('coefficient-a').addEventListener('input', updateEquation);
        document.getElementById('coefficient-b').addEventListener('input', updateEquation);
        document.getElementById('coefficient-c').addEventListener('input', updateEquation);

        // Initial equation display
        updateEquation();

        function updateEquation() {
            const a = parseFloat(document.getElementById('coefficient-a').value) || 0;
            const b = parseFloat(document.getElementById('coefficient-b').value) || 0;
            const c = parseFloat(document.getElementById('coefficient-c').value) || 0;

            let equation = "y = ";

            if (a === 0 && b === 0 && c === 0) {
                equation += "0";
            } else {
                if (a !== 0) {
                    equation += a === 1 ? "x²" : a === -1 ? "-x²" : a + "x²";
                }

                if (b !== 0) {
                    if (b > 0 && a !== 0) {
                        equation += " + ";
                    } else if (b < 0) {
                        equation += " - ";
                    }
                    equation += Math.abs(b) === 1 ? "x" : Math.abs(b) + "x";
                }

                if (c !== 0) {
                    if (c > 0 && (a !== 0 || b !== 0)) {
                        equation += " + ";
                    } else if (c < 0) {
                        equation += " - ";
                    }
                    equation += Math.abs(c);
                }
            }

            document.getElementById('equation-display').textContent = equation;
        }

        function calculateQuadratic() {
            const a = parseFloat(document.getElementById('coefficient-a').value) || 0;
            const b = parseFloat(document.getElementById('coefficient-b').value) || 0;
            const c = parseFloat(document.getElementById('coefficient-c').value) || 0;

            // Check if it's a valid quadratic equation
            if (a === 0) {
                alert("Coefficient 'a' cannot be zero for a quadratic equation!");
                return;
            }

            fetch('/calculate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ a, b, c }),
            })
            .then(response => response.json())
            .then(data => {
                // Display roots and discriminant
                document.getElementById('root-status').textContent = data.root_status;

                if (data.discriminant >= 0) {
                    const rootsText = data.roots.length > 1
                        ? `x₁ = ${data.roots[0].toFixed(1)}, x₂ = ${data.roots[1].toFixed(1)}`
                        : `x = ${data.roots[0].toFixed(1)}`;
                    document.getElementById('roots').textContent = `Roots: ${rootsText}`;
                } else {
                    document.getElementById('roots').textContent = `Roots: ${data.roots[0]}, ${data.roots[1]}`;
                }

                document.getElementById('discriminant').textContent = `Discriminant: ${data.discriminant.toFixed(1)}`;
                document.getElementById('results').style.display = 'block';

                // Plot the curve
                const trace = {
                    x: data.x_values,
                    y: data.y_values,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'y = ax² + bx + c',
                    line: {
                        color: 'rgb(55, 128, 191)',
                        width: 3
                    }
                };

                // Add points for roots if they are real
                const traces = [trace];

                if (data.discriminant >= 0) {
                    const rootPoints = {
                        x: data.roots.map(root => parseFloat(root)),
                        y: data.roots.map(_ => 0),
                        type: 'scatter',
                        mode: 'markers',
                        name: 'Roots',
                        marker: {
                            color: 'red',
                            size: 10
                        }
                    };
                    traces.push(rootPoints);
                }

                const layout = {
                    title: 'Quadratic Function',
                    xaxis: {
                        title: 'x'
                    },
                    yaxis: {
                        title: 'y'
                    },
                    hovermode: 'closest',
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'white'
                };

                Plotly.newPlot('plot', traces, layout);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while calculating. Please try again.');
            });
        }
    </script>
</body>
</html>